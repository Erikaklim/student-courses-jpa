<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<f:metadata>
    <f:event type="preRenderView" listener="#{groups.initializeGroupPage}" />
    <f:viewParam name="courseId" value="#{groups.courseId}" />
</f:metadata>

<h:head>
    <title>Group</title>
    <link rel="stylesheet" type="text/css" href="style.css"/>
</h:head>
<h:body>
    <h2>#{groups.findYear(groups.groupId)}#{groups.findGroupNumber(groups.groupId)}</h2>
    <table class="list-table">
        <thead>
        <tr>
            <th>Group</th>
        </tr>
        </thead>
        <tbody>
        <ui:repeat value="#{groups.allStudents}" var="student">
            <tr>
                <td>
                    <h:link value="#{student.name} #{student.lastName}" outcome="studentCourses.xhtml">
                        <f:param name="studentId" value="#{student.id}"/>
                    </h:link>
                </td>
            </tr>
        </ui:repeat>
        </tbody>
    </table>
    <div style="margin-top: 10px">Create a new group: </div>
    <h:form style="margin-top: 10px">
        <h:panelGrid columns="2">
            <h:outputLabel for="year" value="Year:"/>
            <h:selectOneMenu id="year" value="#{groups.groupToCreate.year}" required="true">
                <f:selectItem itemLabel="Select year..." itemValue="" />
                <f:selectItem itemLabel="2024" itemValue="2024" />
                <f:selectItem itemLabel="2023" itemValue="2023" />
                <f:selectItem itemLabel="2022" itemValue="2022" />
                <f:selectItem itemLabel="2021" itemValue="2021" />
                <f:ajax listener="#{groups.onYearChange}" render="number" />
            </h:selectOneMenu>
            <h:outputLabel for="number" value="Group number:"/>
            <h:outputText id="number" value="#{groups.nextGroupNumber}" required="true"/>
        </h:panelGrid>
        <div style="margin-top: 10px">
            <h:commandButton value="Add group" action="#{groups.createGroup()}">
            </h:commandButton>
        </div>
    </h:form>
</h:body>
</html>
